<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.3">
<title data-react-helmet="true">How it works | Connext Documentation</title><meta data-react-helmet="true" property="og:url" content="https://nxtp-docs.connext.network/Integration/SystemOverview/howitworks"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="How it works | Connext Documentation"><meta data-react-helmet="true" name="description" content="This iteration of Connext&#x27;s network utilizes nxtp, a lightweight protocol for generalized crosschain transfers."><meta data-react-helmet="true" property="og:description" content="This iteration of Connext&#x27;s network utilizes nxtp, a lightweight protocol for generalized crosschain transfers."><link data-react-helmet="true" rel="shortcut icon" href="/img/logomark.ico"><link data-react-helmet="true" rel="canonical" href="https://nxtp-docs.connext.network/Integration/SystemOverview/howitworks"><link data-react-helmet="true" rel="alternate" href="https://nxtp-docs.connext.network/Integration/SystemOverview/howitworks" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://nxtp-docs.connext.network/Integration/SystemOverview/howitworks" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.e93b42eb.css">
<link rel="preload" href="/assets/js/runtime~main.d5701f31.js" as="script">
<link rel="preload" href="/assets/js/main.e3b3df4d.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logomark.png" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logomark.png" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Connext Documentation</b></a><a class="navbar__item navbar__link" href="/">Integration</a><a class="navbar__item navbar__link" href="/Routers/intro">Routers</a></div><div class="navbar__items navbar__items--right"><a href="https://medium.com/connext" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://chat.connext.network" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Chat<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/connext/nxtp" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">🌞</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logomark.png" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logomark.png" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Connext Documentation</b></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/">Integration</a></li><li class="menu__list-item"><a class="menu__link" href="/Routers/intro">Routers</a></li><li class="menu__list-item"><a href="https://medium.com/connext" target="_blank" rel="noopener noreferrer" class="menu__link"><span>Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="menu__list-item"><a href="https://chat.connext.network" target="_blank" rel="noopener noreferrer" class="menu__link"><span>Chat<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="menu__list-item"><a href="https://github.com/connext/nxtp" target="_blank" rel="noopener noreferrer" class="menu__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu menu--responsive thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/">👋 Welcome!</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">❓ System Overview</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/Integration/SystemOverview/howitworks">How it works</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Integration/SystemOverview/connextvsxyz">Connext vs XYZ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Integration/SystemOverview/securitymodel">Security Model</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Integration/SystemOverview/chains">Supported Chains</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Integration/SystemOverview/faq">FAQ</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">💡 Quick Start</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Integration/QuickStart/setup">Installation &amp; Setup</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Integration/QuickStart/transfer">Crosschain Txs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Integration/QuickStart/events">Events</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">🤝 Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Integration/Guides/testnet">Testing NXTP Against Testnets</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Integration/Guides/calling-a-contract">Calling a Contract on the Receiving Chain</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Integration/Guides/initiating-from-contract">Initiating a Crosschain Transaction from a Smart Contract</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Integration/Guides/tx-history-status">Active Transaction Status &amp; Historical Transaction Status</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">📚 API Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Integration/APIReference/sdkAPI">SDK</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Integration/APIReference/contractAPI">Contract</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="markdown"><header><h1 class="h1Heading_27L5">How it works</h1></header><p>This iteration of Connext&#x27;s network utilizes <a href="https://github.com/connext/nxtp" target="_blank" rel="noopener noreferrer">nxtp</a>, a lightweight protocol for generalized crosschain transfers.</p><p>Nxtp is made up of a simple contract that uses a locking pattern to prepare and fulfill transactions, a network of offchain routers that participate in pricing auctions and pass calldata between chains, and a user-side sdk that finds routes and prompts onchain transactions.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="transaction-lifecycle"></a>Transaction Lifecycle<a class="hash-link" href="#transaction-lifecycle" title="Direct link to heading">#</a></h2><p><img alt="HighLevelFlow" src="/assets/images/HighLevelFlow-8fa010ecd5303fc6b12c9ecb54e5a83b.png"></p><p>Transactions go through three phases:</p><ol><li><strong>Route Auction:</strong> User broadcasts to our network signalling their desired route. Routers respond with sealed bids containing commitments to fulfilling the transaction within a certain time and price range.</li><li><strong>Prepare:</strong> Once the auction is completed, the transaction can be prepared. The user submits a transaction to <code>TransactionManager</code> contract on sender-side chain containing router&#x27;s signed bid. This transaction locks up the users funds on the sending chiain. Upon detecting an event containing their signed bid from the chain, router submits the same transaction to <code>TransactionManager</code> on the receiver-side chain, and locks up a corresponding amount of liquidity. The amount locked on the receiving chain is <code>sending amount - auction fee</code> so the router is incentivized to complete the transaction.</li><li><strong>Fulfill:</strong> Upon detecting the <code>TransactionPrepared</code> event on the receiver-side chain, the user signs a message and sends it to a relayer, who will earn a fee for submission. The relayer (which is typically another router) then submits the message to the <code>TransactionManager</code> to complete the user&#x27;s transaction on receiver-side chain and claim the funds locked by the router. A relayer is used here to allow users to submit transactions with arbitrary calldata on the receiving chain without needing gas to do so. The router then submits the same signed message and completes transaction on sender-side, unlocking the original <code>amount</code>.</li></ol><p>If a transaction is not fulfilled within a fixed <code>expiry</code>, it reverts and can be reclaimed by the party that called prepare on each chain (initiator). Additionally, transactions can be cancelled unilaterally by the person owed funds on that chain (router for sending chain, user for receiving chain) prior to <code>expiry</code>.</p><p>It is important to note that neither participant should require a store to complete these transactions. All information to <code>prepare</code>, <code>fulfill</code>, or <code>cancel</code> transactions should be retrievable through contract events.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="architecture"></a>Architecture<a class="hash-link" href="#architecture" title="Direct link to heading">#</a></h2><p><img alt="Architecture" src="/assets/images/Architecture-6db700297f1357f8b5459ce1df5d2ef7.png"></p><p>The system contains the following pieces:</p><ul><li>Contracts - hold funds for all network participants, and lock/unlock based on data submitted by users and routers</li><li>Subgraph - enables scalable querying/responding by caching onchain data and events.</li><li>TxService - resiliently attempts to send transactions to chain (with retries, etc.)</li><li>Messaging - prepares, sends, and listens for message data over nats</li><li>Router - listens for events from messaging service and subgraph, and then dispatches transactions to txService</li><li>SDK - creates auctions, listens for events and creates transactions on the user side.</li></ul></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/integer-underflow/documentation/docs/Integration/SystemOverview/howitworks.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« 👋 Welcome!</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/Integration/SystemOverview/connextvsxyz"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Connext vs XYZ »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#transaction-lifecycle" class="table-of-contents__link">Transaction Lifecycle</a></li><li><a href="#architecture" class="table-of-contents__link">Architecture</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Connext, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.d5701f31.js"></script>
<script src="/assets/js/main.e3b3df4d.js"></script>
</body>
</html>